{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020-09-01-cca175/","result":{"data":{"site":{"siteMetadata":{"title":"Capitanfuturo"}},"markdownRemark":{"id":"bad9e69c-2f13-5475-82d9-6f973a2f21cf","excerpt":"ðŸ’¾ Premessa Questâ€™anno ho provato a rinnovare la certificazione come Spark Developer su piattaforma Cloudera. Nel mondo Big Data abbiamo assistito alla piÃ¹â€¦","html":"<h2>ðŸ’¾ Premessa</h2>\n<p>Questâ€™anno ho provato a rinnovare la certificazione come Spark Developer su piattaforma Cloudera. Nel mondo Big Data abbiamo assistito alla piÃ¹ grande operazione di fusione di aziende concorrenti e in Cloudera abbiamo visto confluire Hortonworks.\nDalle due Ã¨ nata una nuova distribuzione CDH 6.x e da inzio anno 2020 hanno rirpistinato la certifcazione <a href=\"https://university.cloudera.com/content/cca175\">CCA-175</a> basata su Spark 2.\nLa macchina virtuale offerta per fare training oltre ad essere esosa di risorse occupa anche un ragguardevole spazio su disco. Ecco che lâ€™idea di poter usare la precedente macchina virtuale cloudera quickstart con Spark 2 puÃ² essere una valida alternativa per esercitarsi e non mettere a sedere il proprio pc.\nIn questo post scrivo alcuni appunti su come installare il tutto.</p>\n<h2>Fase preliminare</h2>\n<h3>Download</h3>\n<p>Come prima cosa dobbiamo procurarci lâ€™immagine della virtual machine da questo indirizzo: <a href=\"https://downloads.cloudera.com/demo_vm/virtualbox/cloudera-quickstart-vm-5.13.0-0-virtualbox.zip\">https://downloads.cloudera.com/demo_vm/virtualbox/cloudera-quickstart-vm-5.13.0-0-virtualbox.zip</a>.</p>\n<h3>Importazione</h3>\n<p>Avviamo il nostro VirtualBox e importiamo la macchina dal menu principale alla voce <em>File -> Importa</em></p>\n<ul>\n<li>Se possibile impostate RAM a 8192 MB e CPU a 2</li>\n</ul>\n<h2>Impostazioni iniziali</h2>\n<h3>Aggiungere le guest addition</h3>\n<p>Installare le Guest Addition di Virtualbox dal menu di Virtualbox -> Dispositivi -> inserisci lâ€™immagine del cd delle Guest Addition.</p>\n<p>Si avvierÃ  una procedura automatica e vi verrÃ  chiesta la password di root che Ã¨</p>\n<table>\n<thead>\n<tr>\n<th>Utente</th>\n<th>Password</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>root</td>\n<td>cloudera</td>\n</tr>\n</tbody>\n</table>\n<p>Una volta riavviata la macchina virtuale possiamo dotarci degli appunti bidirezionali dal menu:</p>\n<p>Dispositivi -> Appunti condivisi -> Bidirezionale</p>\n<p>Adesso possiamo copia-incollare snippet e comandi senza problemi da questo sito per esempio.</p>\n<h3>Impostare la tastiera e layout italiano</h3>\n<p>system -> preferences -> keyboard preferences\naggiungere italiano ed eliminare americano</p>\n<h2>Installazione Spark 2</h2>\n<p>Per lâ€™installazione il consiglio Ã¨ quello di seguire questo articolo di <a href=\"https://medium.com/@yesilliali/installing-apache-spark-2-x-to-cloudera-quickstart-wm-dd5314e6d9bd\">Ali Yesilli</a> con la sola accortezza di <strong>NON DISINSTALLARE LA VERSIONE 1.7 DI JAVA</strong>.\nVersioni diverse di Java possono convivere senza problemi e mantenendo la 1.7 non rischierete di perdere le configurazioni per HDFS, (che fa comunque parte dellâ€™esame) utile per importare esercizi e per controllare i file prodotti.</p>\n<ul>\n<li>Installare da terminale Java 8 con il comando:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> java-1.8.0-openjdk</code></pre></div>\n<ul>\n<li>Prendere nota della versione di Hadoop presente con il comando da terminale:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">hadoop version</code></pre></div>\n<ul>\n<li>\n<p>Scaricare dal sito ufficiale <a href=\"http://spark.apache.org/downloads.html\">http://spark.apache.org/downloads.html</a> la versione opportuna.</p>\n</li>\n<li>\n<p>Decomprimere lâ€™archivio e spostarlo in <em>/usr/local/spark/</em></p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> Downloads/\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-xvf</span> /home/cloudera/Downloads/spark-2.4.6-bin-hadoop2.6.tgz\n<span class=\"token function\">sudo</span> <span class=\"token function\">mv</span> spark-2.4.6bin-hadoop2.6 /usr/local/spark</code></pre></div>\n<ul>\n<li>Modificare i percorsi negli script di lancio di pyspark, spark-shell e spark-submit. Per agganciare il nuovo eseguibile di Spark 2 bisogna sostituire il percorso:</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Precedente percorso</th>\n<th>Nuovo percorso</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/usr/lib/spark</td>\n<td>/usr/local/spark</td>\n</tr>\n</tbody>\n</table>\n<p>nei file:</p>\n<ul>\n<li>\n<p>/usr/bin/pyspark</p>\n</li>\n<li>\n<p>/usr/bin/spark-shell</p>\n</li>\n<li>\n<p>/usr/bin/spark-submit</p>\n</li>\n<li>\n<p>Impostare nel PATH della shell la nuova versione di Java appena installata andando a modificare il file <em>.bashrc</em> inserendo alla fine:</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">JAVA_HOME</span><span class=\"token operator\">=</span>/usr/lib/jvm/jre-1.8.0-openjdk.x86_64\n\n<span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token environment constant\">$HOME</span>/bin:<span class=\"token variable\">$JAVA_HOME</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token environment constant\">PATH</span></code></pre></div>\n<h2>Lavorare con Spark2 + Avro + Hive</h2>\n<p>Per non aver problemi sulla scrittura del metastore senza badare a questioni di sicurezza la via piÃ¹ semplice Ã¨ quella di dare tutti i permessi alla directory di Hive</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> <span class=\"token number\">777</span> /tmp/hive</code></pre></div>\n<p>Eseguire la spark-shell con il supporto ad Avro e con il puntamento al metastore di Hive</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">spark<span class=\"token operator\">-</span>shell <span class=\"token operator\">--</span>packages org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>spark<span class=\"token operator\">:</span>spark<span class=\"token operator\">-</span>avro_2<span class=\"token punctuation\">.</span><span class=\"token number\">11</span><span class=\"token operator\">:</span><span class=\"token number\">2.4</span><span class=\"token number\">.5</span> <span class=\"token operator\">--</span>driver<span class=\"token operator\">-</span>java<span class=\"token operator\">-</span>options <span class=\"token string\">\"-Dhive.metastore.uris=thrift://quickstart.cloudera:9083\"</span></code></pre></div>\n<p>e questo dovrebbe bastare per fare gli esercizi di preparazione alla CCA175</p>\n<h2>Tip: Reimpostare la risoluzione video</h2>\n<p>Se qualcosa dovesse andare storto con la risoluzione video della macchina virtuale il comando che fa al caso Ã¨ <em>xrandr</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">xrandr <span class=\"token operator\">--</span>current\nxrandr <span class=\"token operator\">--</span>output VGA<span class=\"token operator\">-</span><span class=\"token number\">0</span> <span class=\"token operator\">--</span>mode <span class=\"token number\">1600</span>x795</code></pre></div>\n<blockquote>\n<p>Lâ€™unica chiave che apre tutte le catene Ã¨ lo studio costante. (Stefano Chiacchiarini)</p>\n</blockquote>","frontmatter":{"title":"Installare Spark 2 sulla vm Cloudera Quickstart 5 (CCA175)","date":"01 September 2020","description":null,"tags":["Software"]}},"previous":{"fields":{"slug":"/2020-08-15-striscia-led/"},"frontmatter":{"title":"Pilotare una striscia LED con Arduino"}},"next":{"fields":{"slug":"/2020-09-15-su-nettuno-piovono-diamanti/"},"frontmatter":{"title":"Su Nettuno piovono diamanti (Adrian Fartade)"}}},"pageContext":{"id":"bad9e69c-2f13-5475-82d9-6f973a2f21cf","previousPostId":"27630782-fe56-5ee1-be0d-404b30d83107","nextPostId":"fcdd07a7-dcea-5922-842d-27b21cf17f20"}},"staticQueryHashes":["2114561082"],"slicesMap":{}}